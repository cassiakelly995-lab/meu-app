<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V9 POWER EDITION | C√ÅSSIA PROMPT</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root {
            --bg: #050505;
            --card: rgba(12, 12, 12, 0.98);
            --text: #ffffff;
            --subtext: rgba(255,255,255,0.5);
            --gold: linear-gradient(135deg, #bf953f 0%, #fcf6ba 45%, #b38728 70%, #fbf5b7 100%);
            --gold-solid: #bf953f;
            --border: rgba(191, 149, 63, 0.3);
            --input-bg: rgba(255,255,255,0.02);
            --focus-overlay: rgba(0,0,0,0);
            --warn-bg: rgba(191,149,63,0.08);
            --res-bg: #000;
            --res-color: #fcf6ba;
        }

        body.light-mode {
            --bg: #f0ece3;
            --card: rgba(255,255,255,0.97);
            --text: #1a1209;
            --subtext: rgba(0,0,0,0.45);
            --border: rgba(139, 100, 20, 0.35);
            --input-bg: rgba(0,0,0,0.03);
            --focus-overlay: rgba(0,0,0,0);
            --warn-bg: rgba(191,149,63,0.12);
            --res-bg: #1a1209;
            --res-color: #fcf6ba;
        }
        body.light-mode .glass-panel { box-shadow: 0 25px 80px rgba(0,0,0,0.12); }
        body.light-mode footer { border-top-color: var(--border); }
        body.light-mode .progress-container { background: rgba(0,0,0,0.06); }

        .focus-mode { --bg: #000000; --focus-overlay: rgba(0,0,0,0.85); }
        .focus-mode header, .focus-mode footer, .focus-mode .logo-v9:first-child { opacity: 0; pointer-events: none; transition: 0.5s; }

        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; transition: background 0.5s, color 0.5s; display: flex; flex-direction: column; min-height: 100vh; overflow-x: hidden; }
        body::before { content: ""; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: var(--focus-overlay); z-index: 1; pointer-events: none; transition: 0.8s; }

        #app-content { display: none; flex-grow: 1; flex-direction: column; align-items: center; justify-content: center; width: 100%; z-index: 2; position: relative; }
        #carregando { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }

        .logo-v9 { font-size: 26px; font-weight: 900; letter-spacing: 10px; background: var(--gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-transform: uppercase; margin: 40px 0; text-align: center; }

        .glass-panel { background: var(--card); width: 92%; max-width: 950px; border-radius: 12px; border: 1px solid var(--border); padding: clamp(20px, 5vw, 50px); box-shadow: 0 25px 80px rgba(0,0,0,1); backdrop-filter: blur(25px); margin-bottom: 40px; position: relative; box-sizing: border-box; transition: 0.5s; }
        .focus-mode .glass-panel { border-color: #bf953f; box-shadow: 0 0 100px rgba(191,149,63,0.1); }

        .progress-group { margin-bottom: 30px; display: none; width: 100%; text-align: left; }
        .label-rigor { font-size: 10px; font-weight: 800; color: #bf953f; letter-spacing: 2px; margin-bottom: 8px; display: block; text-transform: uppercase; }
        .progress-container { width: 100%; background: rgba(255,255,255,0.05); height: 6px; border-radius: 10px; margin-bottom: 15px; overflow: hidden; border: 1px solid rgba(191,149,63,0.1); }
        .progress-bar { width: 0%; height: 100%; background: var(--gold); transition: width 0.2s ease; }

        .btn-supreme { width: 100%; background: var(--gold); color: #000; border: none; padding: 22px; border-radius: 4px; font-weight: 900; cursor: pointer; text-transform: uppercase; letter-spacing: 4px; font-size: 14px; margin-top: 15px; transition: 0.3s; }
        .btn-supreme:hover { filter: brightness(1.2); }

        .btn-copy { background: transparent; color: #bf953f; border: 1px solid #bf953f; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: bold; margin-bottom: 10px; width: fit-content; align-self: flex-end; transition: 0.3s; }
        .btn-copy.copied { background: var(--gold); color: #000; border-color: transparent; }

        input, textarea, select { width: 100%; background: var(--input-bg); border: 1px solid var(--border); padding: 18px; border-radius: 4px; color: var(--text); font-size: 15px; box-sizing: border-box; margin-bottom: 10px; outline: none; transition: 0.3s; }
        input:focus, textarea:focus, select:focus { border-color: var(--gold-solid); }
        input.invalid, select.invalid { border-color: #e05252 !important; }

        select { cursor: pointer; appearance: none; -webkit-appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23bf953f' d='M6 8L1 3h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 18px center; background-color: var(--input-bg); }
        select option { background: #111; color: #fff; }
        body.light-mode select option { background: #fff; color: #111; }

        .char-count { font-size: 10px; color: #bf953f; text-align: right; margin-bottom: 5px; font-weight: bold; letter-spacing: 1px; }

        .quality-bar-wrap { width: 100%; margin-bottom: 20px; }
        .quality-label { font-size: 10px; font-weight: 800; color: var(--gold-solid); letter-spacing: 2px; text-transform: uppercase; display: flex; justify-content: space-between; margin-bottom: 6px; }
        .quality-track { width: 100%; background: rgba(255,255,255,0.05); height: 6px; border-radius: 10px; overflow: hidden; border: 1px solid rgba(191,149,63,0.1); }
        body.light-mode .quality-track { background: rgba(0,0,0,0.06); }
        .quality-fill { height: 100%; border-radius: 10px; transition: width 0.4s ease, background 0.4s; }
        .quality-warn { font-size: 11px; color: #e0a052; margin-top: 6px; display: none; font-weight: 600; letter-spacing: 0.5px; background: var(--warn-bg); padding: 8px 12px; border-radius: 4px; border-left: 3px solid #bf953f; }

        .efetividade-wrap { display: none; margin-bottom: 20px; padding: 16px; border-radius: 8px; border: 1px solid var(--border); background: var(--warn-bg); }
        .efetividade-label { font-size: 10px; font-weight: 800; color: var(--gold-solid); letter-spacing: 2px; text-transform: uppercase; display: flex; justify-content: space-between; margin-bottom: 8px; }
        .efetividade-track { width: 100%; background: rgba(255,255,255,0.05); height: 8px; border-radius: 10px; overflow: hidden; }
        body.light-mode .efetividade-track { background: rgba(0,0,0,0.08); }
        .efetividade-fill { height: 100%; border-radius: 10px; background: var(--gold); transition: width 0.8s ease; }
        .efetividade-msg { font-size: 11px; color: var(--subtext); margin-top: 8px; letter-spacing: 0.3px; }

        .tom-group { display: flex; gap: 8px; margin-bottom: 10px; flex-wrap: wrap; }
        .tom-btn { flex: 1; min-width: 80px; background: var(--input-bg); border: 1px solid var(--border); padding: 10px 8px; border-radius: 4px; color: var(--subtext); font-size: 10px; font-weight: 800; letter-spacing: 1px; cursor: pointer; text-transform: uppercase; text-align: center; transition: 0.2s; }
        .tom-btn.active { background: var(--gold); color: #000; border-color: transparent; }
        .tom-label { font-size: 10px; font-weight: 800; color: var(--gold-solid); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 8px; display: block; }

        #res { height: 300px; border-color: #bf953f; color: var(--res-color); background: var(--res-bg); font-family: 'Courier New', monospace; resize: vertical; min-height: 200px; }

        .top-controls { position: absolute; top: 20px; right: 20px; display: flex; gap: 8px; z-index: 1001; flex-wrap: wrap; justify-content: flex-end; }
        .ctrl-btn { background: none; border: 1px solid #bf953f; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 9px; letter-spacing: 1px; font-weight: 900; color: #bf953f; transition: 0.2s; }
        .ctrl-btn:hover { background: rgba(191,149,63,0.1); }
        .ctrl-btn.active { background: var(--gold); color: #000; border-color: transparent; }

        footer { padding: 40px 20px; text-align: center; font-size: 10px; opacity: 0.5; letter-spacing: 2px; border-top: 1px solid var(--border); width: 100%; box-sizing: border-box; transition: 0.5s; }
        .pdf-action { color: #fcf6ba; font-weight: 900; cursor: pointer; font-size: 12px; text-transform: uppercase; display: block; text-align: left; margin-bottom: 15px; }
        body.light-mode .pdf-action { color: #8a6010; }
    </style>
</head>
<body>

<div class="top-controls">
    <button class="ctrl-btn" id="btnFoco" onclick="toggleFoco()">MODO FOCO</button>
    <button class="ctrl-btn" id="btnTema" onclick="toggleTema()">‚òÄÔ∏è CLARO</button>
</div>

<div id="carregando">
    <div class="logo-v9">C√ÅSSIA PROMPT ‚Ä¢ V9 POWER</div>
</div>

<div id="app-content">
    <div class="logo-v9">V9 POWER EDITION</div>
    <main style="width: 100%; display: flex; flex-direction: column; align-items: center; padding: 0 10px; box-sizing: border-box;">
        <div class="glass-panel" style="display: flex; flex-direction: column;">

            <div class="progress-group" id="prog-area">
                <span class="label-rigor">An√°lise de Dados: <span id="val1">0%</span></span>
                <div class="progress-container"><div class="progress-bar" id="bar1"></div></div>
                <span class="label-rigor">Calibra√ß√£o de Expertise: <span id="val2">0%</span></span>
                <div class="progress-container"><div class="progress-bar" id="bar2"></div></div>
            </div>

            <span class="pdf-action" onclick="document.getElementById('pdf-up').click()">üìé IMPORTAR PDF (M√ÅXIMA PRECIS√ÉO)</span>
            <input type="file" id="pdf-up" accept="application/pdf" style="display:none" onchange="lerPDF(this)">

            <select id="area" onchange="limparInvalid(this); calcEfetividade()">
                <option value="" disabled selected>SELECIONE SUA √ÅREA PROFISSIONAL</option>
                <option value="juridico">‚öñÔ∏è Jur√≠dico / Advocacia</option>
                <option value="medico">üè• Medicina / Sa√∫de</option>
                <option value="contabil">üìä Contabilidade / Finan√ßas</option>
                <option value="engenharia">üîß Engenharia / Arquitetura</option>
                <option value="educacao">üìö Educa√ß√£o / Pedagogia</option>
                <option value="negocios">üíº Neg√≥cios / Gest√£o / RH</option>
                <option value="ti">üíª Tecnologia / TI</option>
                <option value="marketing">üì£ Marketing / Comunica√ß√£o</option>
                <option value="psicologia">üß† Psicologia / Assist√™ncia Social</option>
                <option value="outro">‚ú≥Ô∏è Outra √°rea</option>
            </select>

            <input type="text" id="gerado" placeholder="O QUE DEVE SER GERADO? (EX: RELAT√ìRIO, PARECER, LAUDO...)" oninput="limparInvalid(this); calcEfetividade()">
            <input type="text" id="destino" placeholder="QUAL O OBJETIVO? (EX: CONVENCER, INFORMAR, RESOLVER...)" oninput="calcEfetividade()">
            <input type="text" id="publico" placeholder="PARA QUEM √â? (EX: CLIENTE, JUIZ, DIRETOR, PACIENTE...)" oninput="calcEfetividade()">

            <span class="tom-label">TOM DA ESCRITA</span>
            <div class="tom-group">
                <button class="tom-btn active" data-tom="formal" onclick="selecionarTom(this)">FORMAL</button>
                <button class="tom-btn" data-tom="semiformal" onclick="selecionarTom(this)">SEMIFORMAL</button>
                <button class="tom-btn" data-tom="simples" onclick="selecionarTom(this)">SIMPLES</button>
                <button class="tom-btn" data-tom="persuasivo" onclick="selecionarTom(this)">PERSUASIVO</button>
            </div>

            <textarea id="fatos" rows="10" placeholder="COLE AQUI AS INFORMA√á√ïES, FATOS OU USE O PDF ACIMA" oninput="countChars(); calcQualidade(); calcEfetividade()"></textarea>
            <div class="char-count" id="count">Caracteres: 0</div>

            <div class="quality-bar-wrap">
                <div class="quality-label">
                    <span>QUALIDADE DOS DADOS</span>
                    <span id="quality-pct">0%</span>
                </div>
                <div class="quality-track"><div class="quality-fill" id="quality-fill" style="width:0%"></div></div>
                <div class="quality-warn" id="quality-warn">‚ö† Seus dados est√£o incompletos. Quanto mais detalhes voc√™ fornecer, melhor ser√° o resultado gerado.</div>
            </div>

            <div class="efetividade-wrap" id="efetividade-wrap">
                <div class="efetividade-label">
                    <span>EFETIVIDADE DO PROMPT</span>
                    <span id="efet-pct">0%</span>
                </div>
                <div class="efetividade-track"><div class="efetividade-fill" id="efet-fill" style="width:0%"></div></div>
                <div class="efetividade-msg" id="efet-msg"></div>
            </div>

            <button class="btn-supreme" onclick="executarV9()">EXECUTAR ENGENHARIA V9 POWER</button>

            <div id="res-box" style="display:none; margin-top:40px; border-top: 1px solid var(--border); padding-top: 30px; flex-direction: column;">
                <button class="btn-copy" id="btnCopy" onclick="copyRes()">COPIAR COMANDO PARA IA</button>
                <textarea id="res" readonly></textarea>
                <button class="btn-supreme" onclick="baixar()">EXPORTAR PARA WORD (.DOC)</button>
            </div>
        </div>
    </main>
    <footer>
        C√ÅSSIA PROMPT ¬Æ | V9 POWER EDITION<br>
        A RESPONSABILIDADE √â DE QUEM EST√Å USANDO. O PROGRAMA APENAS GERA O PROMPT.
    </footer>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://promptv25-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);

    function entrar() {
        document.getElementById('carregando').style.display = 'none';
        document.getElementById('app-content').style.display = 'flex';
    }
    setTimeout(entrar, 1500);

    function toggleTema() {
        const body = document.body;
        const btn = document.getElementById('btnTema');
        body.classList.toggle('light-mode');
        btn.textContent = body.classList.contains('light-mode') ? 'üåô ESCURO' : '‚òÄÔ∏è CLARO';
    }

    function toggleFoco() {
        const body = document.body;
        const btn = document.getElementById('btnFoco');
        body.classList.toggle('focus-mode');
        btn.classList.toggle('active');
    }

    let tomSelecionado = 'formal';
    function selecionarTom(el) {
        document.querySelectorAll('.tom-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        tomSelecionado = el.dataset.tom;
        calcEfetividade();
    }

    const tomDesc = {
        formal:      "Linguagem formal, t√©cnica e culta. Adequada para documentos oficiais, processos e relat√≥rios institucionais.",
        semiformal:  "Linguagem semiformal: clara, profissional, sem excesso de tecnicidade. Adequada para e-mails e comunica√ß√µes internas.",
        simples:     "Linguagem simples e acess√≠vel. Adequada para comunica√ß√£o com leigos, clientes e p√∫blico geral.",
        persuasivo:  "Linguagem persuasiva e estrat√©gica. Foco em convencer, engajar e gerar impacto no leitor."
    };

    function countChars() {
        document.getElementById('count').innerText = "Caracteres: " + document.getElementById('fatos').value.length;
    }

    function calcQualidade() {
        const texto = document.getElementById('fatos').value.trim();
        const chars = texto.length;
        const palavras = texto.split(/\s+/).filter(p => p.length > 0).length;

        let pct = 0;
        if (chars >= 50)  pct = 20;
        if (chars >= 200) pct = 40;
        if (chars >= 500) pct = 60;
        if (chars >= 900) pct = 80;
        if (chars >= 1500 && palavras >= 150) pct = 100;

        const fill = document.getElementById('quality-fill');
        const label = document.getElementById('quality-pct');
        const warn = document.getElementById('quality-warn');

        fill.style.width = pct + '%';
        fill.style.background = pct < 40 ? '#e05252' : pct < 70 ? '#e0a052' : '#52c452';
        label.innerText = pct + '%';
        warn.style.display = (pct < 60 && chars > 0) ? 'block' : 'none';
    }

    function calcEfetividade() {
        const area    = document.getElementById('area').value;
        const acao    = document.getElementById('gerado').value.trim();
        const destino = document.getElementById('destino').value.trim();
        const publico = document.getElementById('publico').value.trim();
        const fatos   = document.getElementById('fatos').value.trim();

        let score = 0;
        if (area)               score += 25;
        if (acao.length > 3)    score += 20;
        if (destino.length > 3) score += 15;
        if (publico.length > 3) score += 10;
        if (fatos.length >= 200) score += 15;
        if (fatos.length >= 800) score += 10;
        if (tomSelecionado)      score += 5;

        const wrap = document.getElementById('efetividade-wrap');
        const fill = document.getElementById('efet-fill');
        const pctEl = document.getElementById('efet-pct');
        const msg = document.getElementById('efet-msg');

        if (score > 0) wrap.style.display = 'block';
        fill.style.width = score + '%';
        pctEl.innerText = score + '%';

        if (score < 40)      msg.innerText = "Preencha mais campos para aumentar a efetividade.";
        else if (score < 65) msg.innerText = "Bom come√ßo! Adicione mais detalhes nos dados fornecidos.";
        else if (score < 85) msg.innerText = "√ìtimo! O prompt j√° tem alta qualidade.";
        else                  msg.innerText = "üèÜ Prompt no n√≠vel m√°ximo. Pronto para resultados excepcionais.";
    }

    function limparInvalid(el) { el.classList.remove('invalid'); }

    function copyRes() {
        const text = document.getElementById('res');
        const btn = document.getElementById('btnCopy');
        text.select();
        document.execCommand('copy');
        btn.innerText = "COPIADO COM SUCESSO!";
        btn.classList.add('copied');
        setTimeout(() => { btn.innerText = "COPIAR COMANDO PARA IA"; btn.classList.remove('copied'); }, 2000);
    }

    async function lerPDF(input) {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = async function () {
            const typedarray = new Uint8Array(this.result);
            const pdf = await pdfjsLib.getDocument(typedarray).promise;
            let text = "";
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const content = await page.getTextContent();
                text += content.items.map(s => s.str).join(" ") + "\n";
            }
            document.getElementById('fatos').value = text;
            countChars(); calcQualidade(); calcEfetividade();
        };
        reader.readAsArrayBuffer(file);
    }

    const personas = {
        juridico:   "advogado(a) s√™nior com 20 anos de experi√™ncia em lit√≠gios complexos, dom√≠nio em argumenta√ß√£o, jurisprud√™ncia (STJ, STF, TRTs) e t√©cnica processual.",
        medico:     "m√©dico(a) especialista com 20 anos de experi√™ncia cl√≠nica e acad√™mica, habilidade em laudos, pareceres e relat√≥rios com embasamento cient√≠fico atualizado.",
        contabil:   "contador(a) s√™nior com 20 anos de experi√™ncia em contabilidade, auditoria e finan√ßas corporativas, dom√≠nio das normas IFRS, NBC e legisla√ß√£o tribut√°ria.",
        engenharia: "engenheiro(a) s√™nior com 20 anos de experi√™ncia em projetos complexos, laudos t√©cnicos e normas ABNT.",
        educacao:   "pedagogo(a) s√™nior com 20 anos de experi√™ncia em curr√≠culo, did√°tica e avalia√ß√£o, dom√≠nio das melhores pr√°ticas pedag√≥gicas e da BNCC.",
        negocios:   "consultor(a) executivo(a) s√™nior com 20 anos de experi√™ncia em gest√£o estrat√©gica, RH e organiza√ß√µes, com foco em resultados concretos.",
        ti:         "arquiteto(a) de solu√ß√µes e especialista em TI com 20 anos de experi√™ncia, dom√≠nio em sistemas, seguran√ßa e documenta√ß√£o t√©cnica.",
        marketing:  "estrategista de marketing e comunica√ß√£o s√™nior com 20 anos de experi√™ncia, especialista em copy persuasivo e conte√∫do de alto impacto.",
        psicologia: "psic√≥logo(a) com 20 anos de experi√™ncia, habilidade em relat√≥rios, pareceres e documentos com linguagem t√©cnica √©tica e emp√°tica.",
        outro:      "especialista s√™nior com 20 anos de experi√™ncia na √°rea solicitada, com capacidade anal√≠tica e escrita t√©cnica de alto n√≠vel."
    };

    const regras = {
        juridico:   "- Cite artigos de lei, c√≥digos e jurisprud√™ncia do STJ/STF/TRTs.\n- Nunca invente decis√µes ou processos.\n- Estrutura: qualifica√ß√£o das partes ‚Üí fatos ‚Üí fundamenta√ß√£o ‚Üí pedidos.",
        medico:     "- Baseie-se em evid√™ncias cient√≠ficas e diretrizes cl√≠nicas atuais.\n- Nunca invente dados do paciente ou exames.\n- Estrutura: identifica√ß√£o ‚Üí hist√≥rico ‚Üí an√°lise t√©cnica ‚Üí conclus√£o/conduta.",
        contabil:   "- Cite normas cont√°beis (NBC, IFRS, CFC) e legisla√ß√£o tribut√°ria.\n- Nunca invente valores ou lan√ßamentos.\n- Estrutura: contexto ‚Üí an√°lise ‚Üí fundamenta√ß√£o normativa ‚Üí conclus√£o.",
        engenharia: "- Referencie normas ABNT e legisla√ß√£o aplic√°vel.\n- Nunca invente especifica√ß√µes ou medi√ß√µes.\n- Estrutura: objeto ‚Üí metodologia ‚Üí an√°lise t√©cnica ‚Üí recomenda√ß√µes.",
        educacao:   "- Referencie BNCC, teorias pedag√≥gicas e autores reconhecidos.\n- Nunca invente dados de alunos.\n- Estrutura: contexto ‚Üí diagn√≥stico ‚Üí proposta ‚Üí conclus√£o.",
        negocios:   "- Linguagem objetiva, orientada a dados e resultados.\n- Nunca invente m√©tricas ou proje√ß√µes.\n- Estrutura: contexto ‚Üí an√°lise ‚Üí recomenda√ß√µes ‚Üí pr√≥ximos passos.",
        ti:         "- Terminologia t√©cnica precisa, padr√µes ISO/IEEE quando aplic√°vel.\n- Nunca invente funcionalidades ou dados t√©cnicos.\n- Estrutura: escopo ‚Üí an√°lise ‚Üí solu√ß√£o ‚Üí considera√ß√µes finais.",
        marketing:  "- Linguagem adaptada ao p√∫blico-alvo.\n- Nunca invente dados de mercado ou m√©tricas.\n- Estrutura: contexto ‚Üí desenvolvimento ‚Üí call to action.",
        psicologia: "- Respeite o C√≥digo de √âtica do CFP.\n- Nunca invente informa√ß√µes sobre o avaliado.\n- Estrutura: identifica√ß√£o ‚Üí hist√≥rico ‚Üí an√°lise ‚Üí conclus√£o/recomenda√ß√µes.",
        outro:      "- Linguagem t√©cnica adequada √† √°rea e ao p√∫blico.\n- Nunca invente dados n√£o fornecidos.\n- Estrutura: contexto ‚Üí desenvolvimento l√≥gico ‚Üí conclus√£o."
    };

    function executarV9() {
        const areaEl   = document.getElementById('area');
        const acaoEl   = document.getElementById('gerado');
        const fatosEl  = document.getElementById('fatos');
        const areaVal  = areaEl.value;
        const acaoVal  = acaoEl.value.trim();
        const fatosVal = fatosEl.value.trim();

        let valido = true;
        if (!areaVal)  { areaEl.classList.add('invalid'); valido = false; }
        if (!acaoVal)  { acaoEl.classList.add('invalid'); valido = false; }
        if (!fatosVal) { fatosEl.style.borderColor = '#e05252'; valido = false; }
        else           { fatosEl.style.borderColor = ''; }
        if (!valido) { setTimeout(() => { areaEl.classList.remove('invalid'); acaoEl.classList.remove('invalid'); fatosEl.style.borderColor = ''; }, 2500); return; }

        const area = document.getElementById('prog-area');
        const b1 = document.getElementById('bar1'); const b2 = document.getElementById('bar2');
        const v1 = document.getElementById('val1'); const v2 = document.getElementById('val2');

        area.style.display = 'block';
        let p1 = 0; let p2 = 0;

        let itv = setInterval(() => {
            if (p1 < 100) { p1 += 5; b1.style.width = p1 + '%'; v1.innerText = p1 + '%'; }
            if (p1 > 50 && p2 < 100) { p2 += 10; b2.style.width = p2 + '%'; v2.innerText = p2 + '%'; }

            if (p1 >= 100 && p2 >= 100) {
                clearInterval(itv);

                const acao     = acaoVal;
                const objetivo = document.getElementById('destino').value.trim();
                const publico  = document.getElementById('publico').value.trim();
                const fatos    = fatosVal;
                const persona  = personas[areaVal];
                const regra    = regras[areaVal];
                const tom      = tomDesc[tomSelecionado];

                const promptFinal =
`[C√ÅSSIA PROMPT V9 ‚Äî ENGENHARIA M√ÅXIMA]

PERSONA: Voc√™ √© ${persona}

TAREFA: ${acao}
OBJETIVO: ${objetivo || "n√£o especificado"}
P√öBLICO-ALVO: ${publico || "n√£o especificado ‚Äî adapte o tom ao contexto"}
TOM DA ESCRITA: ${tom}

REGRAS OBRIGAT√ìRIAS:
1. Leia e interprete TODOS os dados fornecidos antes de escrever qualquer coisa.
2. Identifique pontos centrais, dados cr√≠ticos e lacunas existentes.
3. Adapte o tom, vocabul√°rio e n√≠vel t√©cnico ao p√∫blico-alvo e ao tom de escrita definidos acima.
${regra}
4. Se faltar dado essencial, escreva: ‚ö† REVIS√ÉO NECESS√ÅRIA ‚Äî [descreva o dado ausente].
5. NUNCA invente informa√ß√µes. Use exclusivamente o que est√° nos dados abaixo.
6. Entregue o documento completo, estruturado e pronto para uso. Comece direto pelo conte√∫do.

DADOS FORNECIDOS:
${fatos}`;

                document.getElementById('res').value = promptFinal;
                document.getElementById('res-box').style.display = 'flex';
                setTimeout(() => { area.style.display = 'none'; }, 1000);
                document.getElementById('res-box').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }, 60);
    }

    function baixar() {
        const conteudo = document.getElementById('res').value;
        const blob = new Blob(['\ufeff', conteudo], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'CASSIA_PROMPT_V9.doc';
        link.click();
    }
</script>
</body>
</html>
